
@{
    ViewBag.Title = "VKM Cockpit";
    Layout ="~/Views/Shared/_LayoutPageBudgeting.cshtml";
}

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GKX0NP1SYR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-GKX0NP1SYR');
    </script>
    <title>VKM Cockpit</title>
    @section scripts{


        @*CSS Library*@
        <link href="~/Content/bootstrap-select.css" rel="stylesheet" />
        <link href="~/Content/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />

        @*JS Library specific for Bootstrap-Select Dropdown*@
        <script src="~/Scripts/bootstrap-select.js"></script>


        <style>
            .dx-header-row > td[role="columnheader"] > div.dx-datagrid-text-content {
                font-size: 17px;
                font-weight: bold;
            }

            .dx-datagrid-headers .dx-header-row {
                background-color: antiquewhite;
            }

            .dx-header-row {
                color: black;
            }
        </style>

        <script type="text/javascript">
            var dataObjData;
            var dataObj;
            debugger;
            var selected;
            var chartData = [];
            var year = [];
            var Plannedvkm;
            var Utilizedvkm;
            var Percentagevkm;
            var lookup_data;
            var categoryid_selected, itemid_selected, costelement_selected, year_isPO_selected;
            var BUList;
            var CategoryName, ItemName;
            var htmlData, win;
            var BU_list, DEPT_list, Item_list, Category_list, OEM_list, Group_list, CostElement_list;//, OrderStatus_list;
            var selected_ccxc;
            var ItemID;



            $("#gen").prop('disabled', true);

            $(".selectpicker").selectpicker('refresh');
            //$('#ddlCC_XC').prop("selected", false);
            $("#ddlCC_XC").val('').trigger('change');
            $(".selectpicker").selectpicker('refresh');
            $.ajax({

                type: "GET",
                url: "/Cockpit/Lookup",
                success: onsuccess_lookupdata,
                error: onerror_lookupdata
            })


            function onsuccess_lookupdata(response) {
                debugger;
                lookup_data = response.data;

                //Item_list = lookup_data.Item_List;
                //Category_list = lookup_data.Category_List;


                BU_list = lookup_data.BU_List;
                OEM_list = lookup_data.OEM_List;
                DEPT_list = lookup_data.DEPT_List;
                Group_list = lookup_data.Groups_test;
                Item_list = lookup_data.Item_List;
                Category_list = lookup_data.Category_List;
                CostElement_list = lookup_data.CostElement_List;
            }

            function onerror_lookupdata(response) {
                alert("Error lookup");

            }

            //window.onload = function () {
                var ddlYears = document.getElementById("ddlYears");

                var currentYear = (new Date()).getFullYear();

                debugger;
                for (var i = 2019; i <= currentYear+1; i++) {
                    var option = document.createElement("OPTION");
                    option.innerHTML = i;
                    option.value = i;
                    ddlYears.appendChild(option);
                    if (option.value == currentYear || option.value == (currentYear + 1) || option.value == (currentYear - 2)) {
                        if (option.value == currentYear || option.value == (currentYear + 1)) {
                            //if (option.value == (currentYear - 2)) {
                            option.defaultSelected = true;
                            //option.defaultSelected = true;
                        }
                        selected = $("#ddlYears").val();
                    }
                }
            //}

            $(".selectpicker").selectpicker('refresh');


            function fnYearChange(yrselect) {

                selected.length = 0;
                selected = $("#ddlYears").val();
                debugger;

                $("#gen").prop('disabled', false);

            }
            $(function () {
                var create = document.querySelector('.create');
                var genText = document.querySelector("#genText");
                var genSpinner = document.querySelector("#genSpinner");
                create.addEventListener("click", function () {

                    var str = "Please Wait, Comparing...  ";
                    var result = str.bold();
                    genText.innerHTML = result;

                    genSpinner.classList.add('fa');
                    genSpinner.classList.add('fa-spinner');
                    genSpinner.classList.add('fa-pulse');



                });

            $("#gen").click(function () {
                if (selected.length == 1) {
                    $.notify('Please choose two Years to compare !', {
                        globalPosition: "top center",
                        className: "error"
                    });



                    var str = "Compare";
                    var result = str.bold();
                    genText.innerHTML = result;
                    $("#genSpinner").removeClass("fa fa-spinner fa-spin");
                    $("#gen").prop('disabled', true);
                    debugger;

                }
                else if (selected.length == 2) {
                    $.notify('Comparison Table and Chart will be rendered here. Please wait !!', {
                        globalPosition: "top center",
                        className: "info"
                    });

                    if (document.getElementById('ddlCC_XC').selectedIndex == 0) {
                        $.ajax({
                            type: "POST",
                            url: "/Cockpit/VKMSummaryData/",
                            data: { 'years': selected, 'buList': BUList, 'selected_ccxc': selected_ccxc },
                            async: false,
                            success: OnSuccess_VKMSummaryData,
                            error: OnError_VKMSummaryData
                        });

                        $.ajax({
                            type: "POST",
                            url: "/Cockpit/VKMSummaryData/",
                            data: { 'years': selected, 'chart': true, 'buList': BUList, 'selected_ccxc': selected_ccxc },
                            success: OnSuccess_ChartSummaryData,
                            error: OnError_ChartSummaryData
                        });

                    }
                    else {
                        $.ajax({
                            type: "POST",
                            url: "/Cockpit/VKMSummaryData/",
                            data: { 'years': selected, 'buList': BUList },
                            async: false,
                            success: OnSuccess_VKMSummaryData,
                            error: OnError_VKMSummaryData
                        });

                        $.ajax({
                            type: "POST",
                            url: "/Cockpit/VKMSummaryData/",
                            data: { 'years': selected, 'chart': true, 'buList': BUList },
                            success: OnSuccess_ChartSummaryData,
                            error: OnError_ChartSummaryData
                        });

                    }

                }
                else if (selected.length == 3) {
                    $.notify('Comparison Chart will be rendered here. Please wait !!', {
                        globalPosition: "top center",
                        className: "info"
                    });
                    $("#VKMSummaryTable_forCCXC").prop('hidden', true);
                    $("#VKMSummaryTable").prop('hidden', true);
                    debugger;
                    if (document.getElementById('ddlCC_XC').selectedIndex == 0) {

                        $.ajax({
                            type: "POST",
                            url: "/Cockpit/VKMSummaryData/",
                            data: { 'years': selected, 'chart': true, 'buList': BUList, 'selected_ccxc': selected_ccxc },
                            success: OnSuccess_ChartSummaryData,
                            error: OnError_ChartSummaryData
                        });

                    }
                    else {

                        $.ajax({
                            type: "POST",
                            url: "/Cockpit/VKMSummaryData/",
                            data: { 'years': selected, 'chart': true, 'buList': BUList },
                            success: OnSuccess_ChartSummaryData,
                            error: OnError_ChartSummaryData
                        });

                    }

                }
                else {
                    $.notify('Please select appropriate years !', {
                        globalPosition: "top center",
                        className: "error"
                    });


                    var str = "Compare";
                    var result = str.bold();
                    genText.innerHTML = result;
                    $("#genSpinner").removeClass("fa fa-spinner fa-spin");
                    $("#gen").prop('disabled', true);


                }
            })



            });

            debugger;
            $.ajax({
                type: "POST",
                url: "/Cockpit/BUs_forpresentNTID_CCXC/",
                success: OnSuccess_BUs_forpresentNTID,
                error: OnError_BUs_forpresentNTID
            });

            function vkmsummary() {
                $.ajax({
                    type: "POST",
                    url: "/Cockpit/VKMSummaryData/",
                    data: { 'years': selected, 'buList': BUList },
                    async: false,
                    success: OnSuccess_VKMSummaryData,
                    error: OnError_VKMSummaryData
                });

                $.ajax({
                    type: "POST",
                    url: "/Cockpit/VKMSummaryData/",
                    data: { 'years': selected, 'chart': true, 'buList': BUList },
                    success: OnSuccess_ChartSummaryData,
                    error: OnError_ChartSummaryData
                });
            }


            function fnCCXCChange(select) {
                debugger;
                selected_ccxc = select.value;
                if (selected_ccxc == "") {
                    $("#VKMSummaryTable_forCCXC").prop('hidden', true);
                    $("#CostElementDrillDown_Title_CCXC").prop('hidden', true);
                    $("#CostElementDrillDown_CCXC").prop('hidden', true);
                    $("#CategoryDrillDown_Title_CCXC").prop('hidden', true);
                    $("#CategoryDrillDown_CCXC").prop('hidden', true);
                }
                else {
                    $("#gen").prop('disabled', false);


                    $.ajax({
                        type: "POST",
                        url: "/Cockpit/BUs_forpresentNTID_CCXC/",
                        data: { 'ccxc': true, 'selected_ccxc': selected_ccxc },
                        success: OnSuccess_BUs_forpresentNTID,
                        error: OnError_BUs_forpresentNTID
                    });
                    debugger;

                }



            }


            function OnSuccess_BUs_forpresentNTID(response) {
                debugger;
                BUList = response.data;

                if (response.message == "") {
                    vkmsummary();
                }
                //else
                if (response.message == "Ajax call made for BuList check")
                {
                    debugger;

                }
                //else {

                //    $.ajax({
                //        type: "POST",
                //        url: "/Cockpit/VKMSummaryData/",
                //        data: { 'years': selected, 'buList': BUList, 'selected_ccxc': selected_ccxc },
                //        async: false,
                //        success: OnSuccess_VKMSummaryData,
                //        error: OnError_VKMSummaryData
                //    });

                //    $.ajax({
                //        type: "POST",
                //        url: "/Cockpit/VKMSummaryData/",
                //        data: { 'years': selected, 'chart': true, 'buList': BUList, 'selected_ccxc': selected_ccxc },
                //        success: OnSuccess_ChartSummaryData,
                //        error: OnError_ChartSummaryData
                //    });
                //}
            }
            function OnError_BUs_forpresentNTID(response) {
                $.notify('Unable to load BUs of the current user right now, Please Try again later!', {
                    globalPosition: "top center",
                    className: "warn"
                });
            }


            function OnSuccess_VKMSummaryData(data) {
                debugger;
                dataObjCol = eval(data.data.columns);
                dataObjData = eval(data.data.data);

                debugger;
                if (data.message != "") {


                    $("#VKMSummaryTable_forCCXC").prop('hidden', false);
                    $("#CostElementDrillDown_Title_CCXC").prop('hidden', true);
                    $("#CostElementDrillDown_CCXC").prop('hidden', true);
                    $("#CategoryDrillDown_Title_CCXC").prop('hidden', true);
                    $("#CategoryDrillDown_CCXC").prop('hidden', true);

                    $("#VKMSummaryTable").prop('hidden', false);
                    $("#CostElementDrillDown_Title").prop('hidden', false);
                    $("#CostElementDrillDown").prop('hidden', false);
                    $("#CategoryDrillDown_Title").prop('hidden', false);
                    $("#CategoryDrillDown").prop('hidden', false);



                    vkmsummary = $("#VKMSummaryTable_forCCXC").dxDataGrid({

                        dataSource: dataObjData,
                        // columns: dataObjCol,
                        showBorders: true,
                        export: {
                            enabled: true,
                            fileName: "VKM Summary Details"
                        },
                        remoteOperations: true,


                        loadPanel: {
                            enabled: true
                        },
                        hoverStateEnabled: {
                            enabled: true
                        },
                        onCellPrepared: function (e) {

                            if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField === "Cost Element" && e.value != "Totals") {  //Tooltip - specific CostElement for Comparison

                                e.cellElement.mouseover(function (arg) {
                                    tooltipInstance.option("contentTemplate", function (contentElement) {
                                        contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Comparison of Cost Element DrillDown</b></div>`);
                                    });

                                    tooltipInstance.show(arg.target);
                                });

                                e.cellElement.mouseout(function (arg) {
                                    tooltipInstance.hide();
                                });
                            }
                            //else if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField.indexOf("VKM") != -1 && e.values[1] != "Totals") {  //Tooltip - an individual year for a specific costelement totals
                            //    e.cellElement.mouseover(function (arg) {
                            //        tooltipInstance.option("contentTemplate", function (contentElement) {
                            //            contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Cost Element DrillDown</b></div>`);
                            //        });

                            //        tooltipInstance.show(arg.target);
                            //    });

                            //    e.cellElement.mouseout(function (arg) {
                            //        tooltipInstance.hide();
                            //    });

                            //}

                        },



                        onCellClick: function (e) {
                            debugger;
                            $.ajax({
                                type: "POST",
                                url: "/Cockpit/BUs_forpresentNTID_CCXC/",
                                data: { 'ccxc': true, 'selected_ccxc': selected_ccxc, 'Ajax_call_made_for_BuList_check': "Ajax call made for BuList check" },
                                async: false,
                                success: OnSuccess_BUs_forpresentNTID,
                                error: OnError_BUs_forpresentNTID
                            });

                            if (e.rowType == 'data' && e.column.dataField == "Cost Element" && e.value != "Totals") {  //DrillDown of specific CostElement for Comparison
                                costelement_selected = e.value;
                                $.ajax({
                                    type: "POST",
                                    url: "/Cockpit/CostElementDrillDown_comparison/",
                                    data: {
                                        'years': selected, 'CostElement_Chosen': costelement_selected, 'buList': BUList, 'selected_ccxc': selected_ccxc
                                    },
                                    success: OnSuccess_CostElementDrillDown_comparison,
                                    error: OnError_CostElementDrillDown
                                });

                            }
                            //else if (e.rowType === "data" && e.column.dataField.indexOf("VKM") != -1 && e.values[1] != "Totals") {  //DrillDown of an individual year for a specific costelement totals
                            //    costelement_selected = e.values[1];
                            //    year_isPO_selected = e.column.caption;

                            //    $.ajax({
                            //        type: "POST",
                            //        url: "/Cockpit/CostElementDrillDown/",
                            //        data: {
                            //            'Year_isPO': year_isPO_selected, 'CostElement_Chosen': costelement_selected, 'buList': BUList
                            //        },
                            //        success: OnSuccess_CostElementDrillDown,
                            //        error: OnError_CostElementDrillDown
                            //    });

                            //}
                            document.getElementById("CostElementDrillDown_Title_CCXC").innerHTML = " COSTELEMENT BASED DRILL DOWN " + " - " + costelement_selected;
                            document.getElementById("CostElementDrillDown_Title_CCXC").style.fontWeight = "700";



                        },
                        //columns: [
                        //    {
                        //        type: "buttons",
                        //        width: 100,
                        //        alignment: "left",
                        //        buttons: [

                        //            {
                        //                hint: "Submit",
                        //                icon: "check",
                        //                //visible: function (e) {
                        //                //    if (e.row.data.ApprovalHoE == undefined)
                        //                //        e.row.data.ApprovalHoE = false;

                        //                //    return !countdownflag && !e.row.isEditing && !e.row.data.ApprovalHoE/*&& !isOrderApproved(e.row.data.OrderStatus)*/;

                        //                //},
                        //                //onClick: function (e) {
                        //                //    HoEApprove(e.row.data.RequestID, filtered_yr);
                        //                //    e.component.refresh(true);
                        //                //    e.event.preventDefault();
                        //                //}
                        //            }]
                        //    }],
                        //onEditorPreparing: function (e) {

                        //    e.editorOptions.disabled = true;
                        //},
                        //onCellClick: function (e) {
                        //    debugger;

                        //    //if (e.column.dataField = "VKM 2020(Planned)") {
                        //    //    debugger;
                        //    //    alert('2020 Planned');

                        //    //}

                        //    //if (e.rowType == 'data' && e.column.dataField == "VKM 2021(Planned)") {
                        //    //    debugger;
                        //    //    alert('2021 Planned');

                        //    //}







                        //    costelement_selected = e.values[0];
                        //    year_isPO_selected = e.column.caption;

                        //    $.ajax({
                        //        type: "POST",
                        //        url: "/Cockpit/CostElementDrillDown/",
                        //        data: { 'Year_isPO': year_isPO_selected, 'CostElement_Chosen': costelement_selected, 'buList': BUList, 'selected_ccxc': selected_ccxc },
                        //        success: OnSuccess_CostElementDrillDown,
                        //        error: OnError_CostElementDrillDown
                        //    });

                        //},
                        //onContentReady: function (e) {
                        //    debugger;
                        //    alert('ON CONTENT READY');
                        //},

                    });
                    var tooltipInstance = $("#tooltipContainer").dxTooltip({
                        //position: "right"
                    }).dxTooltip("instance");

                    $.notify('Comparison Table for CC loaded successfully !', {
                        globalPosition: "top center",
                        className: "success"
                    });

                    var str = "Compare";
                    var result = str.bold();
                    genText.innerHTML = result;
                    $("#genSpinner").removeClass("fa fa-spinner fa-spin");


                }
                else {
                    $("#VKMSummaryTable_forCCXC").prop('hidden', true);
                    $("#CostElementDrillDown_Title_CCXC").prop('hidden', true);
                    $("#CostElementDrillDown_CCXC").prop('hidden', true);
                    $("#CategoryDrillDown_Title_CCXC").prop('hidden', true);
                    $("#CategoryDrillDown_CCXC").prop('hidden', true);

                    $("#VKMSummaryTable").prop('hidden', false);
                    $("#CostElementDrillDown_Title").prop('hidden', true);
                    $("#CostElementDrillDown").prop('hidden', true);
                    $("#CategoryDrillDown_Title").prop('hidden', true);
                    $("#CategoryDrillDown").prop('hidden', true);


                    vkmsummary = $("#VKMSummaryTable").dxDataGrid({

                        dataSource: dataObjData,

                        //columns: dataObjCol,
                        showBorders: true,
                        remoteOperations: true,
                        export: {
                            enabled: true,
                            fileName: "VKM Summary Details"
                        },

                        loadPanel: {
                            enabled: true
                        },
                        hoverStateEnabled: {
                            enabled: true
                        },
                        //hint: "HAAAAAAAAAI",
                        //columns: [
                        //    {
                        //        type: "buttons",
                        //        width: 50,
                        //        alignment: "left",
                        //        buttons: [

                        //            {
                        //                hint: "Compare",
                        //                icon: "increaseindent",


                        //                onClick: function (e) {
                        //                    debugger;
                        //                    costelement_selected = e.row.data.Cost_Element
                        //                    $.ajax({
                        //                        type: "POST",
                        //                        url: "/Cockpit/CostElementDrillDown_comparison/",
                        //                        data: {
                        //                            'years': selected, 'CostElement_Chosen': costelement_selected, 'buList': BUList
                        //                        },
                        //                        success: OnSuccess_CostElementDrillDown_comparison,
                        //                        error: OnError_CostElementDrillDown
                        //                    });
                        //                    e.component.refresh(true);
                        //                    e.event.preventDefault();
                        //                }
                        //            }]
                        //    },
                        // {

                        //     alignment: "center",
                        //     columns: //dataObjCol  create an array - directly assigned to cols - onload event ; page render event
                        //     [

                        //        {
                        //            dataField: "Cost_Element",

                        //        }, {
                        //            dataField: "VKM 2021(Planned)",
                        //        }, {
                        //            dataField: "VKM 2021(Utilized)",
                        //        }, {
                        //            dataField: "VKM 2022(Planned)",
                        //        }, {
                        //            dataField: "VKM 2022(Utilized)",
                        //        }, {
                        //            dataField: "Change in Value (Planned)",
                        //        }, {
                        //            dataField: "Change in Percentage (Planned)",
                        //        }, {
                        //            dataField: "Change in Value (Utilized)",
                        //        }, {
                        //            dataField: "Change in Percentage (Utilized)",
                        //        },

                        //        ]
                        //    },
                        //],
                        ////onEditorPreparing: function (e) {

                        //    e.editorOptions.disabled = true;
                        //},

                        onCellPrepared: function (e) {

                            if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField === "Cost Element" && e.value != "Totals") {  //Tooltip - specific CostElement for Comparison

                                e.cellElement.mouseover(function (arg) {
                                    tooltipInstance.option("contentTemplate", function (contentElement) {
                                        contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Comparison of Cost Element DrillDown</b></div>`);
                                    });

                                    tooltipInstance.show(arg.target);
                                });

                                e.cellElement.mouseout(function (arg) {
                                    tooltipInstance.hide();
                                });
                            }
                            //else if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField.indexOf("VKM") != -1 && e.values[1] != "Totals") {  //Tooltip - an individual year for a specific costelement totals
                            //    e.cellElement.mouseover(function (arg) {
                            //        tooltipInstance.option("contentTemplate", function (contentElement) {
                            //            contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Cost Element DrillDown</b></div>`);
                            //        });

                            //        tooltipInstance.show(arg.target);
                            //    });

                            //    e.cellElement.mouseout(function (arg) {
                            //        tooltipInstance.hide();
                            //    });

                            //}

                        },

                        onCellClick: function (e) {
                            debugger;

                            $.ajax({
                                type: "POST",
                                url: "/Cockpit/BUs_forpresentNTID_CCXC/",
                                async: false,
                                data: { 'Ajax_call_made_for_BuList_check': "Ajax call made for BuList check" },
                                success: OnSuccess_BUs_forpresentNTID,
                                error: OnError_BUs_forpresentNTID
                            });


                            if (e.rowType == 'data' && e.column.dataField == "Cost Element" && e.value != "Totals") {  //DrillDown of specific CostElement for Comparison
                                costelement_selected = e.value;
                                $.ajax({
                                    type: "POST",
                                    url: "/Cockpit/CostElementDrillDown_comparison/",
                                    data: {
                                        'years': selected, 'CostElement_Chosen': costelement_selected, 'buList': BUList
                                    },
                                    success: OnSuccess_CostElementDrillDown_comparison,
                                    error: OnError_CostElementDrillDown
                                });

                            }
                            //else if (e.rowType === "data" && e.column.dataField.indexOf("VKM") != -1 && e.values[1] != "Totals") {  //DrillDown of an individual year for a specific costelement totals
                            //    costelement_selected = e.values[1];
                            //    year_isPO_selected = e.column.caption;

                            //    $.ajax({
                            //        type: "POST",
                            //        url: "/Cockpit/CostElementDrillDown/",
                            //        data: {
                            //            'Year_isPO': year_isPO_selected, 'CostElement_Chosen': costelement_selected, 'buList': BUList
                            //        },
                            //        success: OnSuccess_CostElementDrillDown,
                            //        error: OnError_CostElementDrillDown
                            //    });

                            //}
                            document.getElementById("CostElementDrillDown_Title").innerHTML = " COSTELEMENT BASED DRILL DOWN " + " - " + costelement_selected;
                            document.getElementById("CostElementDrillDown_Title").style.fontWeight = "700";



                        },
                        //onContentReady: function (e) {
                        //    debugger;
                        //    alert('ON CONTENT READY');
                        //},
                    });

                    var tooltipInstance = $("#tooltipContainer").dxTooltip({
                    }).dxTooltip("instance");


                    $.notify('Comparison Table loaded successfully !', {
                        globalPosition: "top center",
                        className: "success"
                    });

                    var str = "Compare";
                    var result = str.bold();
                    genText.innerHTML = result;
                    $("#genSpinner").removeClass("fa fa-spinner fa-spin");
                }

                $("#gen").prop('disabled', true);


            }




            function OnError_VKMSummaryData(response) {
                debugger;
                $.notify('Unable to load VKM Summary right now, Please Try again later!', {
                    globalPosition: "top center",
                    className: "warn"
                });
                var str = "Try Again";
                var result = str.bold();
                genText.innerHTML = result;
                $("#genSpinner").removeClass("fa fa-spinner fa-spin");
            }


            function OnSuccess_ChartSummaryData(data) {
                debugger;
                //var chartData = [];

                dataObj = eval(data.data.data);
                //for (i = 0; i < dataObj.length; i++) {

                //    var c_Planned = [];
                //    var c_Utilized = [];
                //    var c_Percentage = [];
                //    //var Totals = [];
                //    debugger;
                //    c_Planned.push({ c_planned: dataObj[i].Planned });
                //    c_Utilized.push({ c_utilized: dataObj[i].Utilized });
                //    c_Percentage.push({ c_percentage: dataObj[i].Percentage_Utilization });
                //    year.push({ year: dataObj[i].Year });
                //    debugger;
                //    //chartData.push({
                //    //    year: dataObj[i].Year, Plannedvkm: c_Planned, Utilizedvkm: c_Utilized, Percentagevkm: c_Percentage
                //    //});

                //    //chartData.push({ year: dataObj[i].Year, plannedMAE: parseInt(dataObj[i].Planned_MAE), plannedNMAE: parseInt(dataObj[i].Planned_Non_MAE), plannedsw: parseInt(dataObj[i].Planned_Software), plannedTotals: parseInt(dataObj[i].Planned_Total), utilizedMAE: parseInt(dataObj[i].Utilized_MAE), utilizedNMAE: parseInt(dataObj[i].Utilized_Non_MAE), utilizedsw: parseInt(dataObj[i].Utilized_Software), utilizedTotals: parseInt(dataObj[i].Utilized_Total), perMAE: parseInt(dataObj[i].Per_MAE_Utilization), perNMAE: parseInt(dataObj[i].Per_NMAE_Utilization), perSW: parseInt(dataObj[i].Per_Software_Utilization), perTotals: parseInt(dataObj[i].Per_Totals_Utilization) });
                //}
                debugger;


                $("#chart").dxChart({

                    dataSource: dataObj,
                    title: {
                        text: "VKM Comparison Chart (2020 - 2021)",
                        font: {
                            size: 26,
                            weight: 800
                        },

                    },

                    //    new DevExpress.data.DataSource({
                    //    store: chartData,

                    //    map: function (item) {
                    //        debugger;
                    //        return $.extend({

                    //            plMAE: item.AllMAE[0].plannedMAE,
                    //            utMAE: item.AllMAE[0].utilizedMAE,
                    //            plNMAE: item.AllNMAE[0].plannedNMAE,
                    //            utNMAE: item.AllNMAE[0].utilizedNMAE,
                    //            plsw: item.AllSW[0].plannedsw,
                    //            utsw: item.AllSW[0].utilizedsw,
                    //            plTotals: item.AllTotals[0].plannedTotals,
                    //            utTotals: item.AllTotals[0].utilizedTotals,
                    //            //year_CostE: item
                    //        }, item);
                    //    }
                    //}),

                    commonSeriesSettings: {
                        argumentField: "Year",
                        type: "bar",
                        hoverMode: "allArgumentPoints",
                        selectionMode: "allArgumentPoints",

                    },




                    series: [

                        {
                            valueField: "Planned", name: "Planned_VKM",
                            label: {

                                visible: true,
                                format: {
                                    type: "currency",
                                    precision: 0
                                },

                                //    customizeText: function (arg) {
                                //        return arg.value + ;
                                //},


                            }
                        },
                        {
                            valueField: "Utilized", name: "Utilized_VKM",
                            label: {

                                visible: true,
                                format: {
                                    type: "currency",
                                    precision: 0
                                }
                            }
                        },


                        //{ valueField: "plMAE", name: "Planned MAE" },
                        //{ valueField: "utMAE", name: "Utilized MAE" },
                        //{ valueField: "plNMAE", name: "Planned Non-MAE" },
                        //{ valueField: "utNMAE", name: "Utilized Non-MAE" },
                        //{ valueField: "plsw", name: "Planned Software" },
                        //{ valueField: "utsw", name: "Utilized Software" },
                        //{ valueField: "plTotals", name: "Planned Total" },
                        //{ valueField: "utTotals", name: "Utilized Total" },
                        {
                            valueField: "Percentage_Utilization",
                            axis: "Percentage_VKM",
                            type: "line",
                            name: "Percentage Utilization",
                            label: {

                                visible: true,
                                format: {
                                    type: "fixedpoint",
                                    precision: 0
                                },
                                customizeText: function (e) {
                                    return e.valueText + "%";
                                }
                            }
                        }


                    ],



                    legend: {
                        horizontalAlignment: "right",
                        horizontalAlignment: "center", // or "left" | "right"
                        verticalAlignment: "bottom",
                        border: { visible: true },
                        columnCount: 3,

                    },

                    valueAxis: [


                        {

                            position: 'left',

                            valueMarginsEnabled: false,
                            title: {
                                text: "VKM Budget (in Dollars)"
                            }
                        },

                        {
                            name: "Percentage_VKM",
                            position: "right",
                            grid: {
                                visible: true
                            },
                            title: {
                                text: "Percentage Utilization"
                            }
                        }
                    ],


                    export: {
                        enabled: true,
                        fileName: "VKM Comparison Chart"
                    },
                    tooltip: {
                        enabled: true
                    }
                });


                var str = "Compare";
                var result = str.bold();
                genText.innerHTML = result;
                $("#genSpinner").removeClass("fa fa-spinner fa-spin");


                $.notify('Comparison Chart loaded successfully !', {
                    globalPosition: "top center",
                    className: "success"
                });

                $("#gen").prop('disabled', true);

            }


            function OnError_ChartSummaryData(response) {
                debugger;
                $.notify('Unable to load VKM Cockpit Chart right now, Please Try again later!', {
                    globalPosition: "top center",
                    className: "warn"
                });

                var str = "Try Again";
                var result = str.bold();
                genText.innerHTML = result;
                $("#genSpinner").removeClass("fa fa-spinner fa-spin");
            }


            //function OnSuccess_CostElementDrillDown(data) {
            //    debugger;
            //    var objdata = data.data;
            //    if (data.message != "") {
            //        $("#CostElementDrillDown_CCXC").prop('hidden', false);
            //        $("#CategoryDrillDown_CCXC").prop('hidden', true);
            //        CostElementDrillDown = $("#CostElementDrillDown_CCXC").dxDataGrid({

            //            dataSource: objdata,

            //            allowColumnReordering: true,
            //            allowColumnResizing: true,
            //            columnChooser: {
            //                enabled: true
            //            },
            //            filterRow: {
            //                visible: true

            //            },
            //            showBorders: true,
            //            headerFilter: {
            //                visible: true,
            //                applyFilter: "auto"
            //            },
            //            selection: {
            //                applyFilter: "auto"
            //            },
            //            loadPanel: {
            //                enabled: true
            //            },
            //            hoverStateEnabled: {
            //                enabled: true
            //            },
            //            paging: {
            //                pageSize: 10
            //            },
            //            searchPanel: {
            //                visible: true,
            //                width: 240,
            //                placeholder: "Search..."
            //            },
            //            onCellClick: function (e) {
            //                debugger;


            //                if (e.rowType == 'data' && e.column.dataField == "CategoryTotals") {
            //                    debugger;
            //                    //alert('2021 Planned');
            //                    categoryid_selected = e.values[1];


            //                    debugger;
            //                    $.ajax({
            //                        type: "POST",
            //                        url: "/Cockpit/CategoryDrillDown/",
            //                        data: { 'Year_isPO': year_isPO_selected, 'CostElement_Chosen': costelement_selected, 'Category_Chosen': categoryid_selected, 'buList': BUList, 'selected_ccxc': selected_ccxc },

            //                        success: OnSuccess_CategoryDrillDown,
            //                        error: OnError_CategoryDrillDown
            //                    });

            //                }



            //            },
            //            columns: [
            //                {
            //                    type: "buttons",
            //                    width: 100,
            //                    alignment: "left",
            //                    buttons: [

            //                        {
            //                            hint: "Submit",
            //                            icon: "check",
            //                            //visible: function (e) {
            //                            //    if (e.row.data.ApprovalHoE == undefined)
            //                            //        e.row.data.ApprovalHoE = false;

            //                            //    return !countdownflag && !e.row.isEditing && !e.row.data.ApprovalHoE/*&& !isOrderApproved(e.row.data.OrderStatus)*/;

            //                            //},
            //                            //onClick: function (e) {
            //                            //    HoEApprove(e.row.data.RequestID, filtered_yr);
            //                            //    e.component.refresh(true);
            //                            //    e.event.preventDefault();
            //                            //}
            //                        }]
            //                },
            //                {

            //                    alignment: "center",
            //                    columns: [
            //                        {
            //                            caption: " COSTELEMENT BASED DRILL DOWN " + " - " + year_isPO_selected + " " + costelement_selected ,
            //                            alignment: "center",
            //                            columns: [

            //                                {
            //                                    dataField: "CategoryID",
            //                                    caption: "Category",
            //                                    setCellValue: function (rowData, value) {

            //                                        rowData.CategoryID = value;
            //                                    },
            //                                    lookup: {
            //                                        dataSource: function (options) {

            //                                            return {

            //                                                store: Category_list,


            //                                            };
            //                                        },

            //                                        valueExpr: "ID",
            //                                        displayExpr: "Category"

            //                                    }

            //                                },

            //                                "CategoryTotals",


            //                            ],



            //                        }],
            //                }],


            //        });



            //    }
            //    else {
            //        $("#CostElementDrillDown").prop('hidden', false);
            //        $("#CategoryDrillDown").prop('hidden', true);
            //        CostElementDrillDown = $("#CostElementDrillDown").dxDataGrid({

            //            dataSource: objdata,

            //            allowColumnReordering: true,
            //            allowColumnResizing: true,
            //            columnChooser: {
            //                enabled: true
            //            },
            //            filterRow: {
            //                visible: true

            //            },
            //            showBorders: true,
            //            headerFilter: {
            //                visible: true,
            //                applyFilter: "auto"
            //            },
            //            selection: {
            //                applyFilter: "auto"
            //            },
            //            loadPanel: {
            //                enabled: true
            //            },
            //            hoverStateEnabled: {
            //                enabled: true
            //            },
            //            paging: {
            //                pageSize: 10
            //            },
            //            searchPanel: {
            //                visible: true,
            //                width: 240,
            //                placeholder: "Search..."
            //            },

            //            columns: [
            //                {
            //                    type: "buttons",
            //                    width: 90,
            //                    alignment: "left",

            //                },
            //                {

            //                    alignment: "center",
            //                    columns: [
            //                        {
            //                            caption: " COSTELEMENT BASED DRILL DOWN " + " - " + year_isPO_selected + " " + costelement_selected,
            //                            alignment: "center",
            //                            columns: [

            //                                {
            //                                    dataField: "CategoryID",
            //                                    caption: "Category",
            //                                    setCellValue: function (rowData, value) {

            //                                        rowData.CategoryID = value;
            //                                    },
            //                                    lookup: {
            //                                        dataSource: function (options) {

            //                                            return {

            //                                                store: Category_list,


            //                                            };
            //                                        },

            //                                        valueExpr: "ID",
            //                                        displayExpr: "Category"

            //                                    }

            //                                },

            //                                "CategoryTotals",

            //                            ],



            //                        }],
            //                }],

            //            onCellPrepared: function (e) {

            //                //if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField === "Cost Element" && e.value != "Totals") {  //Tooltip - specific CostElement for Comparison

            //                //    e.cellElement.mouseover(function (arg) {
            //                //        tooltipInstance.option("contentTemplate", function (contentElement) {
            //                //            contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Comparison of Cost Element DrillDown</b></div>`);
            //                //        });

            //                //        tooltipInstance.show(arg.target);
            //                //    });

            //                //    e.cellElement.mouseout(function (arg) {
            //                //        tooltipInstance.hide();
            //                //    });
            //                //}
            //                //else
            //                if (e.rowType === "data" && e.column.dataField == "CategoryTotals") {  //Tooltip - an individual year for a specific costelement totals
            //                    e.cellElement.mouseover(function (arg) {
            //                        tooltipInstance_costelt.option("contentTemplate", function (contentElement) {
            //                            contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Category DrillDown</b></div>`);
            //                        });

            //                        tooltipInstance_costelt.show(arg.target);
            //                    });

            //                    e.cellElement.mouseout(function (arg) {
            //                        tooltipInstance_costelt.hide();
            //                    });

            //                }

            //            },

            //            onCellClick: function (e) {
            //                debugger;


            //                if (e.rowType == 'data' && e.column.dataField == "CategoryTotals") {
            //                    debugger;

            //                    categoryid_selected = e.values[1];
            //                    $.ajax({
            //                        type: "GET",
            //                        url: "/Cockpit/CategoryName/",
            //                        data: { 'Category_Chosen': categoryid_selected },

            //                        success: OnSuccess_CategoryName

            //                    });
            //                    function OnSuccess_CategoryName(response) {
            //                        debugger;
            //                        CategoryName = response.data;
            //                    }

            //                    debugger;
            //                    $.ajax({
            //                        type: "POST",
            //                        url: "/Cockpit/CategoryDrillDown/",
            //                        data: { 'Year_isPO': year_isPO_selected, 'CostElement_Chosen': costelement_selected, 'Category_Chosen': categoryid_selected, 'buList': BUList },

            //                        success: OnSuccess_CategoryDrillDown,
            //                        error: OnError_CategoryDrillDown
            //                    });

            //                }



            //            },


            //        });
            //        var tooltipInstance_costelt = $("#tooltipContainer").dxTooltip({
            //            position: "right"
            //        }).dxTooltip("instance");
            //    }
            //}



            function OnSuccess_CostElementDrillDown_comparison(data) {
                debugger;
                var objdata = eval(data.data.data);
                if (data.message != "") {
                    $("#VKMSummaryTable_forCCXC").prop('hidden', false);
                    $("#CostElementDrillDown_Title_CCXC").prop('hidden', false);
                    $("#CostElementDrillDown_CCXC").prop('hidden', false);
                    $("#CategoryDrillDown_Title_CCXC").prop('hidden', true);
                    $("#CategoryDrillDown_CCXC").prop('hidden', true);

                    $("#VKMSummaryTable").prop('hidden', false);
                    $("#CostElementDrillDown_Title").prop('hidden', false);
                    $("#CostElementDrillDown").prop('hidden', false);
                    $("#CategoryDrillDown_Title").prop('hidden', false);
                    $("#CategoryDrillDown").prop('hidden', false);


                    CostElementDrillDown = $("#CostElementDrillDown_CCXC").dxDataGrid({

                        dataSource: objdata,

                        allowColumnReordering: true,
                        allowColumnResizing: true,
                        columnChooser: {
                            enabled: true
                        },
                        filterRow: {
                            visible: true

                        },
                        showBorders: true,
                        export: {
                            enabled: true,
                            fileName: "CostElement Details"
                        },
                        headerFilter: {
                            visible: true,
                            applyFilter: "auto"
                        },
                        selection: {
                            applyFilter: "auto"
                        },
                        loadPanel: {
                            enabled: true
                        },
                        hoverStateEnabled: {
                            enabled: true
                        },
                        paging: {
                            pageSize: 10
                        },
                        searchPanel: {
                            visible: true,
                            width: 240,
                            placeholder: "Search..."
                        },

                        onCellPrepared: function (e) {
                            debugger;

                            if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField === "Category Name") {  //Tooltip - specific CostElement for Comparison

                                e.cellElement.mouseover(function (arg) {
                                    tooltipInstance_costelt.option("contentTemplate", function (contentElement) {
                                        contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Comparison of Category DrillDown</b></div>`);
                                    });

                                    tooltipInstance_costelt.show(arg.target);
                                });

                                e.cellElement.mouseout(function (arg) {
                                    tooltipInstance_costelt.hide();
                                });
                            }
                            //else if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField.indexOf("VKM") != -1) {  //Tooltip - an individual year for a specific costelement totals
                            //    e.cellElement.mouseover(function (arg) {
                            //        tooltipInstance_costelt.option("contentTemplate", function (contentElement) {
                            //            contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Category DrillDown</b></div>`);
                            //        });

                            //        tooltipInstance_costelt.show(arg.target);
                            //    });

                            //    e.cellElement.mouseout(function (arg) {
                            //        tooltipInstance_costelt.hide();
                            //    });

                            //}

                        },

                        onCellClick: function (e) {
                            debugger;
                            $.ajax({
                                type: "POST",
                                url: "/Cockpit/BUs_forpresentNTID_CCXC/",
                                data: { 'ccxc': true, 'selected_ccxc': selected_ccxc, 'Ajax_call_made_for_BuList_check': "Ajax call made for BuList check" },
                                async: false,
                                success: OnSuccess_BUs_forpresentNTID,
                                error: OnError_BUs_forpresentNTID
                            });

                            if (e.rowType == 'data' && e.column.dataField == "Category Name") {  //DrillDown of specific CostElement for Comparison
                                categoryid_selected = e.value;

                                //$.ajax({
                                //    type: "GET",
                                //    url: "/Cockpit/CategoryName/",
                                //    data: { 'Category_Chosen': categoryid_selected },

                                //    success: OnSuccess_CategoryName

                                //});
                                //function OnSuccess_CategoryName(response) {
                                //    debugger;
                                //    CategoryName = response.data;
                                //}

                                $.ajax({
                                    type: "POST",
                                    url: "/Cockpit/CategoryDrillDown_comparison/",
                                    data: { 'years': selected, 'CostElement_Chosen': costelement_selected, 'Category_Chosen': categoryid_selected, 'buList': BUList, 'selected_ccxc': selected_ccxc},

                                    success: OnSuccess_CategoryDrillDown_comparison,
                                    error: OnError_CategoryDrillDown
                                });

                                document.getElementById("CategoryDrillDown_Title_CCXC").innerHTML = " CATEGORY BASED DRILL DOWN " + " - " + categoryid_selected;
                                document.getElementById("CategoryDrillDown_Title_CCXC").style.fontWeight = "700";

                            }
                            //else if (e.rowType === "data" && e.column.dataField.indexOf("VKM") != -1) {  //DrillDown of an individual year for a specific costelement totals
                            //    categoryid_selected = e.values[1];
                            //    year_isPO_selected = e.column.caption;

                            //    $.ajax({
                            //        type: "GET",
                            //        url: "/Cockpit/CategoryName/",
                            //        data: { 'Category_Chosen': categoryid_selected },

                            //        success: OnSuccess_CategoryName

                            //    });
                            //    function OnSuccess_CategoryName(response) {
                            //        debugger;
                            //        CategoryName = response.data;
                            //    }


                            //    $.ajax({
                            //        type: "POST",
                            //        url: "/Cockpit/CategoryDrillDown/",
                            //        data: { 'Year_isPO': year_isPO_selected, 'CostElement_Chosen': costelement_selected, 'Category_Chosen': categoryid_selected, 'buList': BUList },

                            //        success: OnSuccess_CategoryDrillDown,
                            //        error: OnError_CategoryDrillDown
                            //    });

                            //}





                        },

                        //onCellClick: function (e) {
                        //    debugger;


                        //    if (e.rowType == 'data' && e.column.dataField == "CategoryTotals") {
                        //        debugger;
                        //        //alert('2021 Planned');
                        //        categoryid_selected = e.values[1];


                        //        debugger;
                        //        $.ajax({
                        //            type: "POST",
                        //            url: "/Cockpit/CategoryDrillDown/",
                        //            data: { 'Year_isPO': year_isPO_selected, 'CostElement_Chosen': costelement_selected, 'Category_Chosen': categoryid_selected, 'buList': BUList, 'selected_ccxc': selected_ccxc },

                        //            success: OnSuccess_CategoryDrillDown,
                        //            error: OnError_CategoryDrillDown
                        //        });

                        //    }



                        //},
                        //columns: [
                        //    {
                        //        type: "buttons",
                        //        width: 100,
                        //        alignment: "left",
                        //        buttons: [

                        //            {
                        //                hint: "Submit",
                        //                icon: "check",
                        //                //visible: function (e) {
                        //                //    if (e.row.data.ApprovalHoE == undefined)
                        //                //        e.row.data.ApprovalHoE = false;

                        //                //    return !countdownflag && !e.row.isEditing && !e.row.data.ApprovalHoE/*&& !isOrderApproved(e.row.data.OrderStatus)*/;

                        //                //},
                        //                //onClick: function (e) {
                        //                //    HoEApprove(e.row.data.RequestID, filtered_yr);
                        //                //    e.component.refresh(true);
                        //                //    e.event.preventDefault();
                        //                //}
                        //            }]
                        //    },
                        //    {

                        //        alignment: "center",
                        //        //columns: [
                        //        //    {
                        //        //        //caption: " COSTELEMENT BASED DRILL DOWN " + " - " + " " + costelement_selected,
                        //        //        alignment: "center",
                        //        //        columns: [

                        //        //            {
                        //        //                dataField: "CategoryID",
                        //        //                caption: "Category",
                        //        //                setCellValue: function (rowData, value) {

                        //        //                    rowData.CategoryID = value;
                        //        //                },
                        //        //                lookup: {
                        //        //                    dataSource: function (options) {

                        //        //                        return {

                        //        //                            store: Category_list,


                        //        //                        };
                        //        //                    },

                        //        //                    valueExpr: "ID",
                        //        //                    displayExpr: "Category"

                        //        //                }

                        //        //            },

                        //        //            //"CategoryTotals",
                        //        //            {
                        //        //                dataField: "VKM 2021(Planned)",
                        //        //            }, {
                        //        //                dataField: "VKM 2021(Utilized)",
                        //        //            }, {
                        //        //                dataField: "VKM 2022(Planned)",
                        //        //            }, {
                        //        //                dataField: "VKM 2022(Utilized)",
                        //        //            },

                        //        //        ],



                        //           // }],
                        //    }],


                    });
                    var tooltipInstance_costelt = $("#tooltipContainer").dxTooltip({
                        // position: "right"
                    }).dxTooltip("instance");


                    $.notify('Cost Element drilldown for CC loaded successfully !', {
                        globalPosition: "top center",
                        className: "success"
                    });

                    var str = "Compare";
                    var result = str.bold();
                    genText.innerHTML = result;
                    $("#genSpinner").removeClass("fa fa-spinner fa-spin");


                }
                else {
                    if (document.getElementById('ddlCC_XC').selectedIndex == 0) {
                        $("#VKMSummaryTable_forCCXC").prop('hidden', false);
                        $("#CostElementDrillDown_Title_CCXC").prop('hidden', false);
                        $("#CostElementDrillDown_CCXC").prop('hidden', false);
                        $("#CategoryDrillDown_Title_CCXC").prop('hidden', true);
                        $("#CategoryDrillDown_CCXC").prop('hidden', true);
                    }
                    else {
                        $("#VKMSummaryTable_forCCXC").prop('hidden', true);
                        $("#CostElementDrillDown_Title_CCXC").prop('hidden', true);
                        $("#CostElementDrillDown_CCXC").prop('hidden', true);
                        $("#CategoryDrillDown_Title_CCXC").prop('hidden', true);
                        $("#CategoryDrillDown_CCXC").prop('hidden', true);

                    }

                    $("#VKMSummaryTable").prop('hidden', false);
                    $("#CostElementDrillDown_Title").prop('hidden', false);
                    $("#CostElementDrillDown").prop('hidden', false);
                    $("#CategoryDrillDown_Title").prop('hidden', true);
                    $("#CategoryDrillDown").prop('hidden', true);


                    CostElementDrillDown = $("#CostElementDrillDown").dxDataGrid({

                        dataSource: objdata,

                        allowColumnReordering: true,
                        allowColumnResizing: true,
                        columnChooser: {
                            enabled: true
                        },
                        filterRow: {
                            visible: true

                        },
                        showBorders: true,
                        export: {
                            enabled: true,
                            fileName: "CostElement DrillDown Details"
                        },
                        headerFilter: {
                            visible: true,
                            applyFilter: "auto"
                        },
                        selection: {
                            applyFilter: "auto"
                        },
                        loadPanel: {
                            enabled: true
                        },
                        hoverStateEnabled: {
                            enabled: true
                        },
                        paging: {
                            pageSize: 10
                        },
                        searchPanel: {
                            visible: true,
                            width: 240,
                            placeholder: "Search..."
                        },

                        //columns: [
                        //    {
                        //        type: "buttons",
                        //        width: 90,
                        //        alignment: "left",

                        //    },
                        //    {

                        //        alignment: "center",
                        //        //columns: [
                        //        //    {
                        //        //        //caption: " COSTELEMENT BASED DRILL DOWN " + " - "  + costelement_selected,
                        //        //        alignment: "center",
                        //        //        columns: [

                        //        //            {
                        //        //                dataField: "CategoryID",
                        //        //                caption: "Category",
                        //        //                setCellValue: function (rowData, value) {

                        //        //                    rowData.CategoryID = value;
                        //        //                },
                        //        //                lookup: {
                        //        //                    dataSource: function (options) {

                        //        //                        return {

                        //        //                            store: Category_list,


                        //        //                        };
                        //        //                    },

                        //        //                    valueExpr: "ID",
                        //        //                    displayExpr: "Category"

                        //        //                }

                        //        //            },

                        //        //            //"CategoryTotals",
                        //        //            {
                        //        //                dataField: "VKM 2021(Planned)",
                        //        //            }, {
                        //        //                dataField: "VKM 2021(Utilized)",
                        //        //            }, {
                        //        //                dataField: "VKM 2022(Planned)",
                        //        //            }, {
                        //        //                dataField: "VKM 2022(Utilized)",
                        //        //            },

                        //        //        ],



                        //        //    }],
                        //    }],

                        onCellPrepared: function (e) {
                            debugger;

                            if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField === "Category Name") {  //Tooltip - specific CostElement for Comparison

                                e.cellElement.mouseover(function (arg) {
                                    tooltipInstance_costelt.option("contentTemplate", function (contentElement) {
                                        contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Comparison of Category DrillDown</b></div>`);
                                    });

                                    tooltipInstance_costelt.show(arg.target);
                                });

                                e.cellElement.mouseout(function (arg) {
                                    tooltipInstance_costelt.hide();
                                });
                            }
                            //else if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField.indexOf("VKM") != -1) {  //Tooltip - an individual year for a specific costelement totals
                            //    e.cellElement.mouseover(function (arg) {
                            //        tooltipInstance_costelt.option("contentTemplate", function (contentElement) {
                            //            contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Category DrillDown</b></div>`);
                            //        });

                            //        tooltipInstance_costelt.show(arg.target);
                            //    });

                            //    e.cellElement.mouseout(function (arg) {
                            //        tooltipInstance_costelt.hide();
                            //    });

                            //}

                        },

                        onCellClick: function (e) {
                            debugger;

                            $.ajax({
                                type: "POST",
                                url: "/Cockpit/BUs_forpresentNTID_CCXC/",
                                async: false,
                                data: { 'Ajax_call_made_for_BuList_check': "Ajax call made for BuList check" },
                                success: OnSuccess_BUs_forpresentNTID,
                                error: OnError_BUs_forpresentNTID
                            });

                            if (e.rowType == 'data' && e.column.dataField == "Category Name") {  //DrillDown of specific CostElement for Comparison
                                categoryid_selected = e.value;

                                //$.ajax({
                                //    type: "GET",
                                //    url: "/Cockpit/CategoryName/",
                                //    data: { 'Category_Chosen': categoryid_selected },

                                //    success: OnSuccess_CategoryName

                                //});
                                //function OnSuccess_CategoryName(response) {
                                //    debugger;
                                //    CategoryName = response.data;
                                //}

                                $.ajax({
                                    type: "POST",
                                    url: "/Cockpit/CategoryDrillDown_comparison/",
                                    data: { 'years': selected, 'CostElement_Chosen': costelement_selected, 'Category_Chosen': categoryid_selected , 'buList': BUList },

                                    success: OnSuccess_CategoryDrillDown_comparison,
                                    error: OnError_CategoryDrillDown
                                });

                                document.getElementById("CategoryDrillDown_Title").innerHTML = " CATEGORY BASED DRILL DOWN " + " - " + categoryid_selected;
                                document.getElementById("CategoryDrillDown_Title").style.fontWeight = "700";

                            }
                            //else if (e.rowType === "data" && e.column.dataField.indexOf("VKM") != -1) {  //DrillDown of an individual year for a specific costelement totals
                            //    categoryid_selected = e.values[1];
                            //    year_isPO_selected = e.column.caption;

                            //    $.ajax({
                            //        type: "GET",
                            //        url: "/Cockpit/CategoryName/",
                            //        data: { 'Category_Chosen': categoryid_selected },

                            //        success: OnSuccess_CategoryName

                            //    });
                            //    function OnSuccess_CategoryName(response) {
                            //        debugger;
                            //        CategoryName = response.data;
                            //    }


                            //    $.ajax({
                            //        type: "POST",
                            //        url: "/Cockpit/CategoryDrillDown/",
                            //        data: { 'Year_isPO': year_isPO_selected, 'CostElement_Chosen': costelement_selected, 'Category_Chosen': categoryid_selected, 'buList': BUList },

                            //        success: OnSuccess_CategoryDrillDown,
                            //        error: OnError_CategoryDrillDown
                            //    });

                            //}





                        },


                    });
                    var tooltipInstance_costelt = $("#tooltipContainer").dxTooltip({
                       // position: "right"
                    }).dxTooltip("instance");


                    $.notify('Cost Element drilldown loaded successfully !', {
                        globalPosition: "top center",
                        className: "success"
                    });
                }

            }


            function OnError_CostElementDrillDown(response) {
                debugger;
                $.notify('Unable to load CostElement based Drill Down right now, Please Try again later!', {
                    globalPosition: "top center",
                    className: "warn"
                });
            }




            //function OnSuccess_CategoryDrillDown(data) {
            //    debugger;
            //    var objdata = data.data;
            //    if (data.message != "") {
            //        $("#CostElementDrillDown_CCXC").prop('hidden', false);
            //        $("#CategoryDrillDown_CCXC").prop('hidden', false);

            //        CategoryDrillDown = $("#CategoryDrillDown_CCXC").dxDataGrid({

            //            dataSource: objdata,

            //            allowColumnReordering: true,
            //            allowColumnResizing: true,
            //            columnChooser: {
            //                enabled: true
            //            },
            //            filterRow: {
            //                visible: true

            //            },
            //            showBorders: true,
            //            headerFilter: {
            //                visible: true,
            //                applyFilter: "auto"
            //            },
            //            selection: {
            //                applyFilter: "auto"
            //            },
            //            loadPanel: {
            //                enabled: true
            //            },
            //            hoverStateEnabled: {
            //                enabled: true
            //            },
            //            paging: {
            //                pageSize: 10
            //            },
            //            searchPanel: {
            //                visible: true,
            //                width: 240,
            //                placeholder: "Search..."
            //            },
            //            onCellClick: function (e) {
            //                debugger;
            //                alert('ON CELL CLICK');
            //                if (e.column.dataField = "CategoryTotals") {
            //                    debugger;
            //                    alert('2020 Planned');

            //                }




            //            },
            //            columns: [

            //                {

            //                    alignment: "center",
            //                    columns: [
            //                        {
            //                            caption: " CATEGORY BASED DRILL DOWN " + " - " + year_isPO_selected + " " + CategoryName,
            //                            alignment: "center",
            //                            columns: [

            //                                {
            //                                    dataField: "ItemID",
            //                                    caption: "Item",
            //                                    setCellValue: function (rowData, value) {

            //                                        rowData.ItemID = value;
            //                                    },
            //                                    lookup: {
            //                                        dataSource: function (options) {

            //                                            return {

            //                                                store: Item_list,


            //                                            };
            //                                        },
            //                                        valueExpr: "S_No",
            //                                        displayExpr: "Item_Name"

            //                                    }

            //                                },

            //                                "ItemTotals",

            //                            ],



            //                        }],
            //                }],


            //        });

            //    }
            //    else {
            //        $("#CostElementDrillDown").prop('hidden', false);
            //        $("#CategoryDrillDown").prop('hidden', false);
            //        CategoryDrillDown = $("#CategoryDrillDown").dxDataGrid({

            //            dataSource: objdata,

            //            allowColumnReordering: true,
            //            allowColumnResizing: true,
            //            columnChooser: {
            //                enabled: true
            //            },
            //            filterRow: {
            //                visible: true

            //            },
            //            showBorders: true,
            //            headerFilter: {
            //                visible: true,
            //                applyFilter: "auto"
            //            },
            //            selection: {
            //                applyFilter: "auto"
            //            },
            //            loadPanel: {
            //                enabled: true
            //            },
            //            hoverStateEnabled: {
            //                enabled: true
            //            },
            //            paging: {
            //                pageSize: 10
            //            },
            //            searchPanel: {
            //                visible: true,
            //                width: 240,
            //                placeholder: "Search..."
            //            },

            //            onCellPrepared: function (e) {

            //                //if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField === "Cost Element" && e.value != "Totals") {  //Tooltip - specific CostElement for Comparison

            //                //    e.cellElement.mouseover(function (arg) {
            //                //        tooltipInstance.option("contentTemplate", function (contentElement) {
            //                //            contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Comparison of Cost Element DrillDown</b></div>`);
            //                //        });

            //                //        tooltipInstance.show(arg.target);
            //                //    });

            //                //    e.cellElement.mouseout(function (arg) {
            //                //        tooltipInstance.hide();
            //                //    });
            //                //}
            //                //else
            //                if (e.rowType === "data" && e.column.dataField == "ItemTotals") {  //Tooltip - an individual year for a specific costelement totals
            //                    e.cellElement.mouseover(function (arg) {
            //                        tooltipInstance_category.option("contentTemplate", function (contentElement) {
            //                            contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Item Details</b></div>`);
            //                        });

            //                        tooltipInstance_category.show(arg.target);
            //                    });

            //                    e.cellElement.mouseout(function (arg) {
            //                        tooltipInstance_category.hide();
            //                    });

            //                }

            //            },
            //            onCellClick: function (e) {
            //                debugger;
            //                alert('ON CELL CLICK');
            //                if (e.column.dataField = "CategoryTotals") {
            //                    debugger;
            //                    alert('2020 Planned');

            //                }




            //            },
            //            columns: [

            //                {

            //                    alignment: "center",
            //                    columns: [
            //                        {
            //                            caption: " CATEGORY BASED DRILL DOWN " + " - " + year_isPO_selected + " " + CategoryName,
            //                            alignment: "center",
            //                            columns: [

            //                                {
            //                                    dataField: "ItemID",
            //                                    caption: "Item",
            //                                    setCellValue: function (rowData, value) {

            //                                        rowData.ItemID = value;
            //                                    },
            //                                    lookup: {
            //                                        dataSource: function (options) {

            //                                            return {

            //                                                store: Item_list,


            //                                            };
            //                                        },
            //                                        valueExpr: "S_No",
            //                                        displayExpr: "Item_Name"

            //                                    }

            //                                },

            //                                "ItemTotals",

            //                            ],



            //                        }],
            //                }],


            //        });

            //        var tooltipInstance_category = $("#tooltipContainer").dxTooltip({
            //            position: "right"
            //        }).dxTooltip("instance");



            //    }


            //}




            function OnSuccess_CategoryDrillDown_comparison(data) {
                debugger;
                var objdata = eval(data.data.data);
                if (data.message != "") {

                    $("#VKMSummaryTable_forCCXC").prop('hidden', false);
                    $("#CostElementDrillDown_Title_CCXC").prop('hidden', false);
                    $("#CostElementDrillDown_CCXC").prop('hidden', false);
                    $("#CategoryDrillDown_Title_CCXC").prop('hidden', false);
                    $("#CategoryDrillDown_CCXC").prop('hidden', false);

                    $("#VKMSummaryTable").prop('hidden', false);
                    $("#CostElementDrillDown_Title").prop('hidden', false);
                    $("#CostElementDrillDown").prop('hidden', false);
                    $("#CategoryDrillDown_Title").prop('hidden', false);
                    $("#CategoryDrillDown").prop('hidden', false);


                    CategoryDrillDown = $("#CategoryDrillDown_CCXC").dxDataGrid({

                        dataSource: objdata,

                        allowColumnReordering: true,
                        allowColumnResizing: true,
                        columnChooser: {
                            enabled: true
                        },
                        filterRow: {
                            visible: true

                        },
                        showBorders: true,
                        headerFilter: {
                            visible: true,
                            applyFilter: "auto"
                        },
                        selection: {
                            applyFilter: "auto"
                        },
                        export: {
                            enabled: true,
                            fileName: "Category DrillDown Details"
                        },
                        loadPanel: {
                            enabled: true
                        },
                        hoverStateEnabled: {
                            enabled: true
                        },
                        paging: {
                            pageSize: 10
                        },
                        searchPanel: {
                            visible: true,
                            width: 240,
                            placeholder: "Search..."
                        },

                        onCellPrepared: function (e) {
                            debugger;

                            if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField === "Item Name") {  //Tooltip - specific CostElement for Comparison

                                e.cellElement.mouseover(function (arg) {
                                    tooltipInstance_category.option("contentTemplate", function (contentElement) {
                                        contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Item Details</b></div>`);
                                    });

                                    tooltipInstance_category.show(arg.target);
                                });

                                e.cellElement.mouseout(function (arg) {
                                    tooltipInstance_category.hide();
                                });
                            }
                            //else if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField.indexOf("VKM") != -1) {  //Tooltip - an individual year for a specific costelement totals
                            //    e.cellElement.mouseover(function (arg) {
                            //        tooltipInstance_category.option("contentTemplate", function (contentElement) {
                            //            contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Item Details of the Totals</b></div>`);
                            //        });

                            //        tooltipInstance_category.show(arg.target);
                            //    });

                            //    e.cellElement.mouseout(function (arg) {
                            //        tooltipInstance_category.hide();
                            //    });

                            //}

                        },

                        onCellClick: function (e) {
                            debugger;
                            $.ajax({
                                type: "POST",
                                url: "/Cockpit/BUs_forpresentNTID_CCXC/",
                                data: { 'ccxc': true, 'selected_ccxc': selected_ccxc, 'Ajax_call_made_for_BuList_check': "Ajax call made for BuList check" },
                                async: false,
                                success: OnSuccess_BUs_forpresentNTID,
                                error: OnError_BUs_forpresentNTID
                            });

                            if (e.rowType == 'data' && e.column.dataField == "Item Name") {  //DrillDown of specific CostElement for Comparison
                                itemname_selected = e.value;

                                //$.ajax({
                                //    type: "GET",
                                //    url: "/Cockpit/ItemName/",
                                //    data: { 'Item_Chosen': itemid_selected },

                                //    success: OnSuccess_ItemName

                                //});
                                //function OnSuccess_ItemName(response) {
                                //    debugger;
                                //    ItemName = response.data;
                                //}

                                //debugger;

                                debugger;
                                //$.ajax({
                                //    type: "POST",
                                //    url: "/Cockpit/ItemDrillDown/",
                                //    data: { 'CostElement_Chosen': costelement_selected, 'Category_Chosen': categoryid_selected, 'Item_Chosen': itemid_selected, 'buList': BUList, 'years': selected },
                                //    success: OnSuccess_ItemDrillDown,
                                //    error: OnError_ItemDrillDown

                                //});
                                //function OnSuccess_ItemDrillDown(response) {
                                //    debugger;
                                //    debugger;
                                //    htmlData = response.data;
                                //    $("#hack").trigger("click");


                                    @*var ItemDrillDown_object = response.data;
                                    //Response.Redirect("ItemDrillDown.cshtml?itemdrilldown_object=" + ItemDrillDown_object);


                                    var url = '@Url.Action("ItemDrillDown_Index", "Cockpit")';
                                    window.location.href = url;*@
                                //}

                                //$("#hack").on("click", function () {
                                //    debugger;
                                //    win = window.open("", "_blank");
                                //    win.document.body.innerHTML = htmlData;

                                //});

                                //function OnError_ItemDrillDown(response) {
                                //    debugger;
                                //    $.notify('Unable to load Item Details requested right now, Please Try again later!', {
                                //        globalPosition: "top center",
                                //        className: "warn"
                                //    });
                                //}


                                @*var url = '@Url.Action("ItemDrillDown_Index", "Cockpit")';
                                window.location.href = url;*@


                                $.ajax({
                                    type: "GET",
                                    url: "/Cockpit/ItemID/",
                                    async: false,
                                    data: { 'Item_Chosen': itemname_selected },

                                    success: OnSuccess_ItemName

                                });
                                function OnSuccess_ItemName(response) {
                                    debugger;
                                    ItemID = response.data;
                                }

                                debugger;
                                var url = '@Html.Raw(Url.Action("ItemDrillDown_Index", "Cockpit",new { Years_Listasstring = "selected", CostElement_Chosen = "costelement_selected", Category_Chosen = "categoryid_selected", Item_Chosen = "ItemID", BuList_Listasstring = "BUList", selected_ccxc= "selected_ccxc" }) )';

                                    var params = url.replace('selected', selected).replace('BUList', BUList).replace('costelement_selected', costelement_selected).replace('categoryid_selected', categoryid_selected).replace('ItemID', ItemID).replace('selected_ccxc', selected_ccxc);
                                debugger;
                                window.open(window.location.href = params, '_blank');

                                //window.location.href = params;

//                                $.ajax({
//type: "POST",
//                                    url: "/Cockpit/CategoryDrillDown_comparison/",
//                                    data: { 'years': selected, 'CostElement_Chosen': costelement_selected, 'Category_Chosen': categoryid_selected, 'buList': BUList },

//                                    success: OnSuccess_CategoryDrillDown_comparison,
//                                    error: OnError_CategoryDrillDown
//                                });

                                        }
                            //else if (e.rowType === "data" && e.column.dataField.indexOf("VKM") != -1) {  //DrillDown of an individual year for a specific costelement totals
                            //    categoryid_selected = e.values[1];
                            //    year_isPO_selected = e.column.caption;

                            //    $.ajax({
                            //            type: "GET",
                            //        url: "/Cockpit/ItemName/",
                            //        data: { 'Item_Chosen': itemid_selected },

                            //        success: OnSuccess_ItemName

                            //    });
                            //    function OnSuccess_ItemName(response) {
                            //                debugger;
                            //                ItemName = response.data;
                            //            }

                            //    $.ajax({
                            //            type: "POST",
                            //        url: "/Cockpit/CategoryDrillDown/",
                            //        data: { 'Year_isPO': year_isPO_selected, 'CostElement_Chosen': costelement_selected, 'Category_Chosen': categoryid_selected, 'buList': BUList },

                            //        success: OnSuccess_CategoryDrillDown,
                            //        error: OnError_CategoryDrillDown
                            //    });

                            //}





                                },




                        //onCellClick: function (e) {
                        //    debugger;
                        //    alert('ON CELL CLICK');
                        //    if (e.column.dataField = "CategoryTotals") {
                        //        debugger;
                        //        alert('2020 Planned');

                        //    }




                        //},
                        //columns: [

                        //    {

                        //        alignment: "center",
                        //        columns: [
                        //            {
                        //                //caption: " CATEGORY BASED DRILL DOWN " + " - "  + " " + CategoryName,
                        //                alignment: "center",
                        //                columns: [

                        //                    {
                        //                        dataField: "ItemID",
                        //                        caption: "Item",
                        //                        //setCellValue: function (rowData, value) {

                        //                        //    rowData.ItemID = value;
                        //                        //},
                        //                        //lookup: {
                        //                        //    dataSource: function (options) {

                        //                        //        return {

                        //                        //            store: Item_list,


                        //                        //        };
                        //                        //    },
                        //                        //    valueExpr: "S_No",
                        //                        //    displayExpr: "Item_Name"

                        //                        //}

                        //                    },

                        //                    {
                        //                        dataField: "VKM 2021(Planned)",
                        //                    }, {
                        //                        dataField: "VKM 2021(Utilized)",
                        //                    }, {
                        //                        dataField: "VKM 2022(Planned)",
                        //                    }, {
                        //                        dataField: "VKM 2022(Utilized)",
                        //                    },

                        //                ],



                        //            }],
                        //    }],


                    });
                    var tooltipInstance_category = $("#tooltipContainer").dxTooltip({
                        //position: "right"
                    }).dxTooltip("instance");


                    $.notify('Category drilldown for CC loaded successfully !', {
                        globalPosition: "top center",
                        className: "success"
                    });

                }
                else {
                    if (document.getElementById('ddlCC_XC').selectedIndex == 0) {
                        $("#VKMSummaryTable_forCCXC").prop('hidden', false);
                        $("#CostElementDrillDown_Title_CCXC").prop('hidden', false);
                        $("#CostElementDrillDown_CCXC").prop('hidden', false);
                        $("#CategoryDrillDown_Title_CCXC").prop('hidden', false);
                        $("#CategoryDrillDown_CCXC").prop('hidden', false);

                    }
                    else {
                        $("#VKMSummaryTable_forCCXC").prop('hidden', true);
                        $("#CostElementDrillDown_Title_CCXC").prop('hidden', true);
                        $("#CostElementDrillDown_CCXC").prop('hidden', true);
                        $("#CategoryDrillDown_Title_CCXC").prop('hidden', true);
                        $("#CategoryDrillDown_CCXC").prop('hidden', true);

                    }


                    $("#VKMSummaryTable").prop('hidden', false);
                    $("#CostElementDrillDown_Title").prop('hidden', false);
                    $("#CostElementDrillDown").prop('hidden', false);
                    $("#CategoryDrillDown_Title").prop('hidden', false);
                    $("#CategoryDrillDown").prop('hidden', false);

                    CategoryDrillDown = $("#CategoryDrillDown").dxDataGrid({

                        dataSource: objdata,

                        allowColumnReordering: true,
                        allowColumnResizing: true,
                        columnChooser: {
                            enabled: true
                        },
                        filterRow: {
                            visible: true

                        },
                        showBorders: true,
                        headerFilter: {
                            visible: true,
                            applyFilter: "auto"
                        },
                        selection: {
                            applyFilter: "auto"
                        },
                        loadPanel: {
                            enabled: true
                        },
                        hoverStateEnabled: {
                            enabled: true
                        },
                        export: {
                            enabled: true,
                            fileName: "Category DrillDown Details"
                        },
                        paging: {
                            pageSize: 10
                        },
                        searchPanel: {
                            visible: true,
                            width: 240,
                            placeholder: "Search..."
                        },

                        onCellPrepared: function (e) {
                            debugger;

                            if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField === "Item Name") {  //Tooltip - specific CostElement for Comparison

                                e.cellElement.mouseover(function (arg) {
                                    tooltipInstance_category.option("contentTemplate", function (contentElement) {
                                        contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Item Details</b></div>`);
                                    });

                                    tooltipInstance_category.show(arg.target);
                                });

                                e.cellElement.mouseout(function (arg) {
                                    tooltipInstance_category.hide();
                                });
                            }
                            //else if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField.indexOf("VKM") != -1) {  //Tooltip - an individual year for a specific costelement totals
                            //    e.cellElement.mouseover(function (arg) {
                            //        tooltipInstance_category.option("contentTemplate", function (contentElement) {
                            //            contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Item Details of the Totals</b></div>`);
                            //        });

                            //        tooltipInstance_category.show(arg.target);
                            //    });

                            //    e.cellElement.mouseout(function (arg) {
                            //        tooltipInstance_category.hide();
                            //    });

                            //}

                        },

                        onCellClick: function (e) {
                            debugger;

                            $.ajax({
                                type: "POST",
                                url: "/Cockpit/BUs_forpresentNTID_CCXC/",
                                async: false,
                                data: { 'Ajax_call_made_for_BuList_check': "Ajax call made for BuList check" },
                                success: OnSuccess_BUs_forpresentNTID,
                                error: OnError_BUs_forpresentNTID
                            });

                            if (e.rowType == 'data' && e.column.dataField == "Item Name") {  //DrillDown of specific CostElement for Comparison
                                itemname_selected = e.value;

                                $.ajax({
                                    type: "GET",
                                    url: "/Cockpit/ItemID/",
                                    async: false,
                                    data: { 'Item_Chosen': itemname_selected },

                                    success: OnSuccess_ItemName

                                });
                                function OnSuccess_ItemName(response) {
                                    debugger;
                                    ItemID = response.data;

                                    debugger;
                                var url = '@Html.Raw(Url.Action("ItemDrillDown_Index", "Cockpit",new { Years_Listasstring = "selected", CostElement_Chosen = "costelement_selected", Category_Chosen = "categoryid_selected", Item_Chosen = "ItemID", BuList_Listasstring = "BUList"}) )';
                                debugger;
                                var params = url.replace('selected', selected).replace('BUList', BUList).replace('costelement_selected', costelement_selected).replace('categoryid_selected', categoryid_selected).replace('ItemID', ItemID);
                                    window.open(params, '_blank');
                                    //window.location.href = params;

                                }

                                //debugger;

                                debugger;
                                //$.ajax({
                                //    type: "POST",
                                //    url: "/Cockpit/ItemDrillDown/",
                                //    data: { 'CostElement_Chosen': costelement_selected, 'Category_Chosen': categoryid_selected, 'Item_Chosen': itemid_selected, 'buList': BUList, 'years': selected },
                                //    success: OnSuccess_ItemDrillDown,
                                //    error: OnError_ItemDrillDown

                                //});
                                //function OnSuccess_ItemDrillDown(response) {
                                //    debugger;
                                //    debugger;
                                //    htmlData = response.data;
                                //    $("#hack").trigger("click");


                                    @*var ItemDrillDown_object = response.data;
                                    //Response.Redirect("ItemDrillDown.cshtml?itemdrilldown_object=" + ItemDrillDown_object);


                                    var url = '@Url.Action("ItemDrillDown_Index", "Cockpit")';
                                    window.location.href = url;*@
                                //}

                                //$("#hack").on("click", function () {
                                //    debugger;
                                //    win = window.open("", "_blank");
                                //    win.document.body.innerHTML = htmlData;

                                //});

                                //function OnError_ItemDrillDown(response) {
                                //    debugger;
                                //    $.notify('Unable to load Item Details requested right now, Please Try again later!', {
                                //        globalPosition: "top center",
                                //        className: "warn"
                                //    });
                                //}


                                @*var url = '@Url.Action("ItemDrillDown_Index", "Cockpit")';
                                window.location.href = url;*@




//                                $.ajax({
//type: "POST",
//                                    url: "/Cockpit/CategoryDrillDown_comparison/",
//                                    data: { 'years': selected, 'CostElement_Chosen': costelement_selected, 'Category_Chosen': categoryid_selected, 'buList': BUList },

//                                    success: OnSuccess_CategoryDrillDown_comparison,
//                                    error: OnError_CategoryDrillDown
//                                });

                                        }
                            //else if (e.rowType === "data" && e.column.dataField.indexOf("VKM") != -1) {  //DrillDown of an individual year for a specific costelement totals
                            //    categoryid_selected = e.values[1];
                            //    year_isPO_selected = e.column.caption;

                            //    $.ajax({
                            //            type: "GET",
                            //        url: "/Cockpit/ItemName/",
                            //        data: { 'Item_Chosen': itemid_selected },

                            //        success: OnSuccess_ItemName

                            //    });
                            //    function OnSuccess_ItemName(response) {
                            //                debugger;
                            //                ItemName = response.data;
                            //            }

                            //    $.ajax({
                            //            type: "POST",
                            //        url: "/Cockpit/CategoryDrillDown/",
                            //        data: { 'Year_isPO': year_isPO_selected, 'CostElement_Chosen': costelement_selected, 'Category_Chosen': categoryid_selected, 'buList': BUList },

                            //        success: OnSuccess_CategoryDrillDown,
                            //        error: OnError_CategoryDrillDown
                            //    });

                            //}





                                },




                        //onCellPrepared: function (e) {

                        //    //if (e.rowType === "data" && e.column.dataField != undefined && e.column.dataField === "Cost Element" && e.value != "Totals") {  //Tooltip - specific CostElement for Comparison

                        //    //    e.cellElement.mouseover(function (arg) {
                        //    //        tooltipInstance.option("contentTemplate", function (contentElement) {
                        //    //            contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Comparison of Cost Element DrillDown</b></div>`);
                        //    //        });

                        //    //        tooltipInstance.show(arg.target);
                        //    //    });

                        //    //    e.cellElement.mouseout(function (arg) {
                        //    //        tooltipInstance.hide();
                        //    //    });
                        //    //}
                        //    //else
                        //    if (e.rowType === "data" && e.column.dataField == "ItemTotals") {  //Tooltip - an individual year for a specific costelement totals
                        //        e.cellElement.mouseover(function (arg) {
                        //            tooltipInstance_category.option("contentTemplate", function (contentElement) {
                        //                contentElement.html(`<div class='tooltipContent'><div><b>Click here to view Item Details</b></div>`);
                        //            });

                        //            tooltipInstance_category.show(arg.target);
                        //        });

                        //        e.cellElement.mouseout(function (arg) {
                        //            tooltipInstance_category.hide();
                        //        });

                        //    }

                        //},

                        //columns: [

                        //    {

                        //        alignment: "center",
                        //        //columns: [
                        //        //    {
                        //        //    //caption: " CATEGORY BASED DRILL DOWN " + " - "  + " " + CategoryName,
                        //        //        alignment: "center",
                        //        //        columns: [

                        //        //            {
                        //        //        dataField: "ItemID",
                        //        //                caption: "Item",
                        //        //            //    setCellValue: function (rowData, value) {

                        //        //            //    rowData.ItemID = value;
                        //        //            //},
                        //        //            //    lookup: {
                        //        //            //dataSource: function (options) {

                        //        //            //        return {

                        //        //            //        store: Item_list,


                        //        //            //            };
                        //        //            //    },
                        //        //            //        valueExpr: "S_No",
                        //        //            //        displayExpr: "Item_Name"

                        //        //            //    }

                        //        //        },

                        //        //           // "ItemTotals",
                        //        //            {
                        //        //        dataField: "VKM 2021(Planned)",
                        //        //            }, {
                        //        //        dataField: "VKM 2021(Utilized)",
                        //        //            }, {
                        //        //        dataField: "VKM 2022(Planned)",
                        //        //            }, {
                        //        //        dataField: "VKM 2022(Utilized)",
                        //        //            },

                        //        //        ],



                        //        //    }],
                        //    }],


                    });

                    var tooltipInstance_category = $("#tooltipContainer").dxTooltip({
                        //position: "right"
                    }).dxTooltip("instance");


                    $.notify('Category drilldown loaded successfully !', {
                        globalPosition: "top center",
                        className: "success"
                    });



                }


            }


            function OnError_CategoryDrillDown(response) {
                debugger;
                $.notify('Unable to load Category based Drill Down right now, Please Try again later!', {
                    globalPosition: "top center",
                    className: "warn"
                });
            }




        </script>
    }





</head>
<body>
    <div>
        <table align="center">
            <tr>
                <td>
                    <img class="card-img mx-auto d-block" src="~/Content/images/vkmcockpit.png" style="width:50px;height:55px;" alt="VKM Cockpit" />
                </td>
                <td><h2 style="text-align:center;margin-top:10px;"><b> VKM Cockpit Options </b></h2></td>
            </tr>
        </table>
    </div>

    <br /> 

    <div>
        <hr />
        <h3 style="text-align:center;padding-bottom:5%;">VKM Comparison (2020 - 2021)</h3>



        <table style="margin:auto;">
            <tr>
               

                <td rowspan="2" class=""> <label style="text-align:right; padding-left: 50px;" class="" >Select for CC View:</label></td>
                <td rowspan="2" class="" id="Site_drpdwn_projtable" @*style="padding-right:100px;*@>
                    <select name="CC_XC" id="ddlCC_XC" class="selectpicker show-tick" onchange="fnCCXCChange(this)" title="Choose for CC view" style="cursor:pointer;" data-live-search="true"  data-style="btn-success" data-display = "static" data-actions-box="true" data-dropup-auto = "false" multiple>
                        <option>NE-CC</option>
                        @*<option>NE-XC</option>*@
                    </select>
                </td>
               
                <td rowspan="2" class=""> <label style="text-align:right;  padding-left: 50px;" class="" > Select VKM Year: </label></td>
                <td rowspan="2" class=""></td>
                <td rowspan="2" class="" style="padding-right:100px; height:15px;">
                    <select id="ddlYears" class="selectpicker show-tick" style="cursor: pointer;padding-right:350px; 
                    " data-live-search="true" data-actions-box="true" data-style="btn-success" onchange="fnYearChange(this)" multiple data-max-options="3"></select>
                </td>


                <td id="button" style="float:right">
                    <button type="button" class="btn btn-info create" id="gen"><b id="genText">Compare</b><i id="genSpinner"></i></button>
                </td>
            </tr>
        </table>






        <table>
            <tr>
                <td style="padding-right: 10px;width: 100%;">
                    <div id="VKMSummaryTable_forCCXC" style="padding-top: 70px;padding-bottom:50px;width:100%" hidden></div>
                </td>


            </tr>
        </table>
        <table align="center" style="width: 70%;">
            <tr>
                <td><h5 id="CostElementDrillDown_Title_CCXC" style="text-align:center;margin-top:70px;" hidden></h5></td>
            </tr>
            <tr>
                <td>
                    <div id="CostElementDrillDown_CCXC" hidden @*style="padding-top: 70px;"*@></div>
                </td>
            </tr>
            <tr>
                <td><h5 id="CategoryDrillDown_Title_CCXC" style="text-align:center;margin-top:70px;" hidden></h5></td>
            </tr>
            <tr>

                <td style="padding-right: 10px">
                    <div id="CategoryDrillDown_CCXC" style="padding-bottom:50px;" hidden></div>
                </td>
            </tr>

        </table>
        <table>
            <!--<tr>

            <td-->
            @*style="display:none; width:0%*@
            <!-->
        <label-->
            @*style="text-align:right;*@
            <!--" class="" for="start date">Year:</label>
            </td>
            <td>
                <select id="ddlYears" class="selectpicker show-tick" style="cursor:pointer;" data-live-search="true" data-actions-box="true" onchange="fnYearChange(this)" multiple data-max-options="3"></select>
            </td>
            <td id="button" style="float:right">
                <button type="button" class="btn btn-info create" id="gen"><b id="genText">Compare</b><i id="genSpinner"></i></button>
            </td>
        </tr>-->



            <tr>
                <td style="padding-right: 10px; width: 70%;">
                    <div id="tooltip1"></div>
                    <span class="tooltiptext" id="click"></span>
                    <div id="tooltipContainer"></div>
                    <div id="VKMSummaryTable" style="padding-top: 70px;padding-bottom:50px;"></div>
                </td>
            </tr>
            <tr>
                <td><h5 id="CostElementDrillDown_Title" style="text-align:center;margin-top:70px;" hidden></h5></td>
            </tr>
            <tr align="center" style="display:inline-block">

                <td style="padding-right: 10px">
                    <div id="CostElementDrillDown" style="padding-bottom:50px; width: 70%;" hidden></div>
                </td>

            </tr>
            <tr>
                <td><h5 id="CategoryDrillDown_Title" style="text-align:center;margin-top:70px;" hidden></h5></td>
            </tr>
            <tr align="center">
                <td style="padding-right: 10px">
                    <div id="CategoryDrillDown" style="padding-bottom:50px; width: 70%;" hidden></div>
                </td>
            </tr>







        </table>
        <input type="button" hidden="hidden" id="hack" />

    </div>

    <div class="demo-container">
        
        @*<select name="Year" id="ddlYears" class="selectpicker" style="cursor:pointer;display:none" data-live-search="true" data_actions_box="true" multiple></select>*@
        
        <div id="chart"></div>
    </div>
    <hr />






</body>

</html>




