Error in fetching Infra Utilisation: Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 Select Utilization,'Total' as RBCode,0 as ManualPer,0 as AutoPer,0 as DowntimePer,sum(AveragePer) as TotalPer from  (
		Select LabName as Utilization ,RBCode, convert(decimal(7,4),((Manual / (Cnt * 99 * 12)) * 100)) as ManualPer, 
		Convert(decimal(7,4),((Automated / (Cnt * 99 * 12)) * 100)) as AutoPer, Convert(decimal(7,4),((Downtime / (Cnt * 99 * 12)) * 100)) as DowntimePer,
		(convert(decimal(7,4),((Manual / (Cnt * 99 * 12)) * 1)) + Convert(decimal(7,4),((Automated / (Cnt * 99 * 12)) * 1)) + convert(decimal(7,4),((Downtime / (Cnt * 99 * 12)) * 1))) as TotalPer,
		convert(decimal(7,4),((Manual + Automated + Downtime) / (TotalIds * 99 * 12)) * 1) as AveragePer from (
		Select TotalIds,Cnt, LabName,RBCode,sum(Manual) as Manual , Sum(Automated) as Automated, Sum(Downtime) as Downtime from (
		select COUNT(*) OVER (partition by labname) as TotalIds,COUNT(A.Id) OVER (partition by labname,rbcode) Cnt,Id ,LabName,RbCode,sum(ManualTotalHours) + sum(ManualCaplTotalHours) as Manual, sum(AutomatedTotalHours) + sum(AutomatedCaplTotalHours) as Automated, sum(DowntimeHours) as Downtime
		 from ( select ComputerID,LabInfo.Id, case when LabTypes.id = 9 then 'CCHIL' else LabTypes.DisplayName end as LabName , LabTypes.DisplayName as LabtypeName, RbCode, 
		ManualTotalHours,ManualCaplTotalHours ,AutomatedTotalHours,AutomatedCaplTotalHours , 0 as DowntimeHours  from DailySummaryTable_v3 
		inner join LabComputersPr on DailySummaryTable_v3.ComputerID = LabComputersPr.Id inner join LabInfo on LabComputersPr.LabId = LabInfo.Id inner join Locations on LabInfo.LocationId = Locations.Id
		inner join Sites on Locations.SiteId = Sites.Id inner join LabTypes on LabInfo.TypeId = LabTypes.Id where LabTypes.id in (8,9,20,57,58,14,26,73,74) and Sites.RbCode in ('Cob','Ban')  and IsActive =1
		and convert(date,date) >= '2022-01-03' and convert(nvarchar,date) <= '2022-04-11' and isnull(LabInfo.CreatedAt,'') <=  '2022-04-11' union 
		select ComputerID,LabInfo.Id, case when LabTypes.id = 9 then 'CCHIL' else LabTypes.DisplayName end as LabName , LabTypes.DisplayName as LabtypeName, RbCode, 
		0 as ManualTotalHours,0 as ManualCaplTotalHours ,0 as AutomatedTotalHours,0 as AutomatedCaplTotalHours, DowntimeHours  from AS_DownTimeSummary 
		inner join LabComputersPr on AS_DownTimeSummary.ComputerID = LabComputersPr.Id	inner join LabInfo on LabComputersPr.LabId = LabInfo.Id inner join Locations on LabInfo.LocationId = Locations.Id
		inner join Sites on Locations.SiteId = Sites.Id inner join LabTypes on LabInfo.TypeId = LabTypes.Id where LabTypes.id in (8,9,20,57,58,14,26,73,74) and Sites.RbCode in ('Cob','Ban')  and IsActive =1
		and convert(date,date) >=  '2022-01-03' and convert(nvarchar,date) <= '2022-04-11' and isnull(LabInfo.CreatedAt,'') <=  '2022-04-11' union  4/12/2022 3:41:20 PM

